<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Family Time Ultra</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <div class="app-shell">
    <!-- SIDEBAR -->
    <aside class="card sidebar">
      <div>
        <div class="brand">
          <div class="brand-logo">FT</div>
          <div class="brand-text">
            <div class="brand-title">Family Time Ultra</div>
            <div class="brand-sub">Una sola app, cinque mondi</div>
          </div>
        </div>

        <div class="profiles-section">
          <div class="profiles-section-title">Profili</div>
          <div class="profiles-list" id="profilesList"></div>
          <div style="margin-top:6px;">
            <span class="profile-pill">
              <span class="profile-pill-dot"></span>
              <span id="activeProfileLabel">Nessun profilo attivo</span>
            </span>
          </div>
        </div>

        <div class="nav-section">
          <div class="nav-title">Sezioni</div>
          <div class="nav-list">
            <button class="nav-btn active" data-page="dashboard">
              <span class="nav-icon">üè†</span><span>Dashboard</span>
            </button>
            <button class="nav-btn" data-page="calendar">
              <span class="nav-icon">üìÖ</span><span>Calendario</span>
            </button>
            <button class="nav-btn" data-page="events">
              <span class="nav-icon">üéüÔ∏è</span><span>Eventi</span>
            </button>
            <button class="nav-btn" data-page="clock">
              <span class="nav-icon">‚è±Ô∏è</span><span>Orologio</span>
            </button>
          </div>
        </div>
      </div>

      <div class="sidebar-footer">
        <div class="footer-line">
          <span>Stato</span>
          <span class="footer-pill">Locale + Cloud</span>
        </div>
        <div class="footer-line">
          <span>Dati locali</span>
          <button id="resetDataBtn" class="footer-pill" style="cursor:pointer;">
            Reset locale
          </button>
        </div>
      </div>
    </aside>

    <!-- MAIN -->
    <main class="card main">
      <div class="section-header">
        <div class="section-title">
          <h2 id="mainSectionTitle">Dashboard</h2>
          <div class="section-sub" id="mainSectionSub">
            Panoramica del tempo, del giorno e dell‚Äôenergia del profilo.
          </div>
        </div>
        <div class="section-tag-pill">
          <span class="section-tag-dot"></span>
          <span id="sectionTagText">Vista principale</span>
        </div>
      </div>

      <!-- DASHBOARD -->
      <section id="page-dashboard">
        <div class="dashboard-grid">
          <div class="clock-card">
            <div class="clock-main-display">
              <div class="clock-time" id="clockTime">--:--</div>
              <div class="clock-seconds" id="clockSeconds">--</div>
            </div>
            <div class="clock-date" id="clockDate">--</div>
            <div class="clock-meta-row">
              <div class="tz-pill">
                <span class="tz-dot"></span>
                <span id="tzText">Fuso orario locale</span>
              </div>
              <div class="last-sync">
                Ultimo aggiornamento <span id="lastUpdateTime">--:--:--</span>
              </div>
            </div>
          </div>

          <div class="quote-card">
            <div class="quote-label">Frase del profilo</div>
            <div class="quote-text" id="quoteText">
              Seleziona un profilo a sinistra per iniziare.
            </div>
            <div class="quote-author" id="quoteAuthor">‚Äî</div>
            <button class="quote-refresh-btn" id="quoteRefreshBtn">
              <span>‚Üª</span><span>Nuova frase</span>
            </button>
          </div>
        </div>

        <div class="today-events-card" style="margin-top:10px;">
          <div class="today-events-card-header">
            <span>Oggi</span>
            <span class="events-pill" id="todayEventsMeta">0 eventi</span>
          </div>
          <div class="today-events-list" id="todayEventsList"></div>
        </div>
      </section>

      <!-- CALENDARIO -->
      <section id="page-calendar" style="display:none; height:100%;">
        <div class="calendar-card">
          <div class="calendar-header">
            <div>
              <span class="calendar-month-label" id="calendarMonthLabel">--</span>
            </div>
            <div class="calendar-nav-btns">
              <button class="calendar-nav-btn" id="prevMonthBtn">‚Üê</button>
              <button class="calendar-nav-btn" id="todayMonthBtn">Oggi</button>
              <button class="calendar-nav-btn" id="nextMonthBtn">‚Üí</button>
            </div>
          </div>
          <div class="calendar-grid" id="calendarGrid"></div>
          <div class="calendar-legend">
            <span class="legend-item">
              <span class="legend-dot"></span><span>Eventi personali</span>
            </span>
            <span class="legend-item">
              <span class="legend-dot legend-dot-shared"></span>
              <span>Eventi condivisi</span>
            </span>
          </div>
        </div>
      </section>

      <!-- EVENTI -->
      <section id="page-events" style="display:none; height:100%;">
        <div class="events-card">
          <div class="events-filter-row">
            <div><span>Eventi</span></div>
            <div class="events-view-toggle">
              <button class="events-view-btn active" data-view="all">Tutti</button>
              <button class="events-view-btn" data-view="profile">Profilo</button>
              <button class="events-view-btn" data-view="shared">Condivisi</button>
            </div>
          </div>
          <div class="events-list" id="eventsList"></div>
          <div class="events-form-row">
            <div class="events-form-inputs">
              <input type="text" id="eventTitleInput" class="input-base"
                     placeholder="Titolo evento" />
              <input type="date" id="eventDateInput" class="input-base" />
              <input type="time" id="eventTimeInput" class="input-base" />
              <label class="checkbox-row">
                <input type="checkbox" id="eventSharedInput" />
                <span>Condiviso</span>
              </label>
            </div>
            <button class="events-add-btn" id="addEventBtn">
              <span>Ôºã</span><span>Aggiungi evento</span>
            </button>
          </div>
        </div>
      </section>

      <!-- OROLOGIO -->
      <section id="page-clock" style="display:none;">
        <div style="display:flex; flex-direction:column; gap:10px; margin-top:8px;">
          <div class="clock-card">
            <div class="clock-main-display">
              <div class="clock-time" id="clockTime2">--:--</div>
              <div class="clock-seconds" id="clockSeconds2">--</div>
            </div>
            <div class="clock-date" id="clockDate2">--</div>
          </div>
          <div class="profile-summary-card">
            <div class="profile-summary-row">
              <span class="profile-summary-key">Profilo attivo</span>
              <span class="profile-summary-value" id="summaryProfileName">‚Äî</span>
            </div>
            <div class="profile-summary-row">
              <span class="profile-summary-key">Eventi futuri (profilo)</span>
              <span class="profile-summary-value" id="summaryUpcomingProfile">0</span>
            </div>
            <div class="profile-summary-row">
              <span class="profile-summary-key">Eventi futuri (condivisi)</span>
              <span class="profile-summary-value" id="summaryUpcomingShared">0</span>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- PANEL DESTRO -->
    <aside class="card right">
      <div class="right-top-section">
        <div class="right-title-row">
          <span>Dettagli profilo</span>
          <span class="inline-pill" id="profileMoodLabel">Seleziona un profilo</span>
        </div>
        <div class="profile-summary-card">
          <div class="profile-summary-row">
            <span class="profile-summary-key">Nome</span>
            <span class="profile-summary-value" id="profileNameLabel">‚Äî</span>
          </div>
          <div class="profile-summary-row">
            <span class="profile-summary-key">Ruolo</span>
            <span class="profile-summary-value" id="profileRoleLabel">‚Äî</span>
          </div>
          <div class="profile-summary-row">
            <span class="profile-summary-key">Tema</span>
            <span class="profile-summary-value" id="profileThemeLabel">‚Äî</span>
          </div>
          <div class="profile-summary-row">
            <span class="profile-summary-key">Eventi totali</span>
            <span class="profile-summary-value" id="profileEventsCountLabel">0</span>
          </div>
        </div>
      </div>
      <div style="margin-top:8px; font-size:0.76rem; color:var(--text-soft);">
        I dati sono salvati sia sul dispositivo sia su Firebase (piano gratuito).
      </div>
    </aside>
  </div>

  <!-- MODAL GIORNO -->
  <div class="modal-backdrop" id="eventModalBackdrop">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title" id="modalDateTitle">Dettagli giorno</div>
        <button class="modal-close-btn" id="closeModalBtn">Chiudi</button>
      </div>
      <div class="modal-body">
        <div id="modalEventsContainer"></div>
        <textarea id="modalNoteText"
          placeholder="Nota per questo giorno (personale per il profilo attivo)..."></textarea>
      </div>
      <div class="modal-footer">
        <button class="btn-danger-outline" id="deleteAllDayEventsBtn">
          Cancella eventi del giorno
        </button>
        <button class="btn-secondary" id="saveModalBtn">
          Salva
        </button>
      </div>
    </div>
  </div>

  <!-- Firebase SDK (compat) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

  <!-- Config + logica -->
  <script src="js/firebase-sync.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
